{% extends "base.html" %}

{% block title %}Rule-based Chatbot{% endblock %}

{% block content %}
<h2>This is the Rule-based Chatbot Page</h2>
<p>Here you can chat using predefined rules.</p>


<script>
  function handlekeypress(event) {
    if (event.key === "Enter") {
      const userInput = document.getElementById("user-input");
      const message = userInput.value.trim();

      if (message === "") return;

      // Display user message in chat
      appendMessage("You", message);
      userInput.value = ""; // Clear input box

      // Send message to Flask backend using fetch
      fetch("/chat/rule-based", {
        method: "POST",
        headers: {
          'Content-Type': 'application/json' // ✅ Tell Flask we're sending JSON
        },
        body: JSON.stringify({ message: message })
        // ✅ Wrap message in JSON
      })
        .then(response => {
          if (!response.ok) {
            throw new Error("Network response was not ok");
          }
          return response.json();
        })
        .then(data => {
          const botReply = data.response;
          appendMessage("Bot", botReply);
        })
        .catch(error => {
          console.error("Error:", error);
          appendMessage("Bot", "Oops! Something went wrong.");
        });
    }
  }

  function appendMessage(sender, message) {
    const chatMessages = document.getElementById("chat-messages");
    const newMessage = document.createElement("p");
    newMessage.innerHTML = `<strong>${sender}:</strong> ${message}`;
    chatMessages.appendChild(newMessage);
    chatMessages.scrollTop = chatMessages.scrollHeight; // Auto-scroll
  }
</script>





{% endblock %}